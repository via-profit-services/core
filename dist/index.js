module.exports=function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=22)}([function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(36));n.BadRequestError=i.default;const o=r(t(37));n.ForbiddenError=o.default;const a=r(t(38));n.NotFoundError=a.default;const s=r(t(39));n.ServerError=s.default;const u=r(t(40));n.UnauthorizedError=u.default},function(e,n,t){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(t(9)),r(t(11)),r(t(16)),r(t(42)),r(t(17))},function(e,n){e.exports=require("fs")},function(e,n){e.exports=require("winston-daily-rotate-file")},function(e,n){e.exports=require("winston")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(4);n.default=r.format.combine(r.format.metadata(),r.format.json(),r.format.timestamp({format:"YYYY-MM-DDTHH:mm:ssZZ"}),r.format.splat(),r.format.printf(e=>{const{timestamp:n,level:t,message:r,metadata:i}=e,o="{}"!==JSON.stringify(i)?i:null;return`${n} ${t}: ${r} ${o?JSON.stringify(o):""}`}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AUTH_LOG_FILENAME="auth-%DATE%.log",n.HTTP_LOG_FILENAME="http-%DATE%.log",n.DEBUG_LOG_FILENAME="debug-%DATE%.log",n.ERRORS_LOG_FILENAME="errors-%DATE%.log",n.SQL_LOG_FILENAME="sql-%DATE%.log"},function(e,n){e.exports=require("chalk")},function(e,n){e.exports=require("path")},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=i(t(2)),a=i(t(8)),s=t(10);n.downloadSchema=e=>r(void 0,void 0,void 0,(function*(){const{endpoint:n,method:t,token:r,filename:i,headers:u}=e,d=yield fetch(n,{method:t||"POST",headers:Object.assign({"Content-Type":"application/json",Authorization:`Bearer ${r}`},u),body:JSON.stringify({query:s.getIntrospectionQuery()})});if(200!==d.status)throw new Error(`Failed to send introspection request with status code ${d.status}`);const c=yield d.json(),l=s.printSchema(s.buildClientSchema(c.data));return o.default.writeFileSync(a.default.resolve(i),l)}))},function(e,n){e.exports=require("graphql/utilities")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(0);var i,o;!function(e){e.ASC="ASC",e.DESC="DESC"}(i=n.IDirectionRange||(n.IDirectionRange={})),function(e){e.EQ="=",e.NEQ="<>",e.GT=">",e.LT="<",e.GTE=">=",e.LTE="<=",e.IN="in",e.NOTIN="notIn"}(o=n.TWhereAction||(n.TWhereAction={})),n.stringToCursor=e=>Buffer.from(String(e),"utf8").toString("base64"),n.cursorToString=e=>Buffer.from(e,"base64").toString("utf8"),n.makeNodeCursor=e=>{const{limit:t,offset:r,revert:i,id:o}=e;return n.stringToCursor(JSON.stringify([t,r,i,o]))},n.getNodeCursor=e=>{const t=n.cursorToString(e);try{const[e,n,r,i]=JSON.parse(t);return{limit:e,offset:n,revert:r,id:i}}catch(n){throw new r.ServerError(`The cursor «${e}» is invalid because it contains the wrong JSON data`)}},n.nodeToEdge=(e,t)=>({node:e,cursor:n.makeNodeCursor(Object.assign(Object.assign({},t),{id:e.id}))}),n.nodesToEdges=(e,t)=>[...e||[]].map(e=>n.nodeToEdge(e,t)),n.convertOrderByToKnex=e=>[...e||[]].map(({field:e,direction:n})=>({column:e,order:n})),n.convertWhereToKnex=(e,n)=>{if(void 0===n)return e;const t=[];return Array.isArray(n)&&n.forEach(([e,n,r])=>{t.push([e,n,r])}),Array.isArray(n)||Object.entries(n).forEach(([e,n])=>{t.push([e,o.EQ,n])}),t.forEach(([n,t,r])=>{switch(!0){case t===o.IN:e.whereIn(n,Array.isArray(r)?r:[r]);break;case t===o.NOTIN:e.whereNotIn(n,Array.isArray(r)?r:[r]);break;default:e.where(n,t,r)}}),e},n.buildCursorConnection=e=>{const{nodes:t,totalCount:r,offset:i,limit:o,revert:a}=e,s=n.nodesToEdges(t,{limit:o,offset:i,revert:Boolean(a)});return{totalCount:r,edges:s,pageInfo:{startCursor:s.length?s[0].cursor:void 0,endCursor:s.length?s[s.length-1].cursor:void 0,hasPreviousPage:i>0,hasNextPage:i+o<r}}},n.buildQueryFilter=e=>{const{first:t,last:r,after:a,before:s,offset:u,orderBy:d,filter:c}=e,l={limit:Math.max(Number(t||r)||30,0),orderBy:d||[],revert:!!r,where:[],offset:Math.max(Number(u)||0,0)};if(a||s){const e=n.getNodeCursor(a||s);l.limit=e.limit,l.offset=e.offset,l.revert=e.revert,l.cursor=e}return l.orderBy.length||l.orderBy.push({field:"createdAt",direction:i.DESC}),l.orderBy.push({field:"id",direction:i.DESC}),void 0!==c&&(Array.isArray(c)&&(l.where=c),Array.isArray(c)||Object.entries(c).forEach(([e,n])=>{l.where.push([e,o.EQ,n])})),l},n.extractNodeField=(e,n)=>[...e].map(e=>e[n]),n.extractNodeIds=e=>n.extractNodeField(e,"id")},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=i(t(2)),a=i(t(44)),s=i(t(45)),u=i(t(18)),d=t(46),c=t(0),l=t(1),f=t(11);var p,m,y;!function(e){e.access="access",e.refresh="refresh"}(p=n.TokenType||(n.TokenType={})),function(e){e.allowed="allowed",e.forbidden="forbidden"}(m=n.AccountStatus||(n.AccountStatus={})),function(e){e.authentificationRequired="authentificationRequired",e.accountNotFound="accountNotFound",e.accountForbidden="accountForbidden",e.invalidLoginOrPassword="invalidLoginOrPassword",e.tokenExpired="tokenExpired",e.isNotAnAccessToken="isNotAnAccessToken",e.isNotARefreshToken="isNotARefreshToken",e.tokenWasRevoked="tokenWasRevoked"}(y=n.ResponseErrorType||(n.ResponseErrorType={}));n.Authentificator=class{constructor(e){this.props=e}static cryptUserPassword(e){const n=a.default.genSaltSync(10);return a.default.hashSync(e,n)}static verifyToken(e,n){if(null===e||""===e)throw new c.UnauthorizedError("The token must be provided");try{const t=o.default.readFileSync(n);return s.default.verify(String(e),t)}catch(e){throw new c.UnauthorizedError("Token verification failed",e)}}registerTokens(e){return r(this,void 0,void 0,(function*(){const{context:n}=this.props,{knex:t,logger:r}=n,i=yield t.select(["id","roles"]).from("accounts").where({id:e.uuid}).first();if("string"!=typeof i.id)throw new c.ServerError(`Account with id[${i.id}] not found`);const o=this.generateTokens({uuid:i.id,roles:i.roles});try{yield t("tokens").insert({id:o.accessToken.payload.id,account:o.accessToken.payload.uuid,type:p.access,deviceInfo:e.deviceInfo,expiredAt:u.default(o.accessToken.payload.exp).format()})}catch(e){throw new c.ServerError("Failed to register access token",e)}try{yield t("tokens").insert({id:o.refreshToken.payload.id,account:o.refreshToken.payload.uuid,type:p.refresh,associated:o.accessToken.payload.id,deviceInfo:e.deviceInfo,expiredAt:u.default(o.refreshToken.payload.exp).format()})}catch(e){throw new c.ServerError("Failed to register refresh token",e)}return r.auth.info("New Access token was registered",o.accessToken.payload),o}))}generateTokens(e,n){var t,r;const{context:i}=this.props,a=(null===(t=n)||void 0===t?void 0:t.access)?n.access:i.jwt.accessTokenExpiresIn,u=(null===(r=n)||void 0===r?void 0:r.refresh)?n.refresh:i.jwt.refreshTokenExpiresIn;try{o.default.accessSync(i.jwt.privateKey)}catch(e){throw new c.ServerError("Failed to open JWT privateKey file",{err:e})}const l=o.default.readFileSync(i.jwt.privateKey),f=Object.assign(Object.assign({},e),{type:p.access,id:d.v4(),exp:Math.floor(Date.now()/1e3)+Number(a),iss:i.jwt.issuer}),m=Object.assign(Object.assign({},e),{type:p.refresh,id:d.v4(),associated:f.id,exp:Math.floor(Date.now()/1e3)+Number(u),iss:i.jwt.issuer}),y=s.default.sign(f,l,{algorithm:i.jwt.algorithm}),v=s.default.sign(m,l,{algorithm:i.jwt.algorithm});return{accessToken:{token:y,payload:Object.assign(Object.assign({},f),{type:p.access})},refreshToken:{token:v,payload:Object.assign(Object.assign({},m),{type:p.refresh})}}}revokeToken(e){return r(this,void 0,void 0,(function*(){const{context:n}=this.props,{knex:t}=n;yield t.del().from("tokens").where({id:e})}))}static extractToken(e,n){const{headers:t,body:r}=n;if(e===p.access){if(l.TOKEN_BEARER_KEY.toLocaleLowerCase()in t){const[e,n]=String(t[l.TOKEN_BEARER_KEY.toLocaleLowerCase()]).split(" ");if(e===l.TOKEN_BEARER&&""!==n)return String(n)}if(l.TOKEN_ACCESS_TOKEN_COOKIE_KEY in n.signedCookies)return String(n.signedCookies[l.TOKEN_ACCESS_TOKEN_COOKIE_KEY]);if(l.TOKEN_ACCESS_TOKEN_COOKIE_KEY in r)return String(r[l.TOKEN_ACCESS_TOKEN_COOKIE_KEY])}if(e===p.refresh){if(l.TOKEN_REFRESH_TOKEN_COOKIE_KEY in n.signedCookies)return String(n.signedCookies[l.TOKEN_REFRESH_TOKEN_COOKIE_KEY]);if(l.TOKEN_REFRESH_TOKEN_COOKIE_KEY in r)return String(r[l.TOKEN_REFRESH_TOKEN_COOKIE_KEY])}return""}checkTokenExist(e){return r(this,void 0,void 0,(function*(){const{context:n}=this.props,{knex:t}=n;return null!==(yield t.select(["id"]).from("tokens").where({id:e}).first())}))}getAccountByLogin(e,n){return r(this,void 0,void 0,(function*(){const{context:t}=this.props,{knex:r}=t,i=yield r.select(["id","password","status","roles"]).from("accounts").where({login:e}).first();return void 0===i?{error:y.accountNotFound,account:!1}:"string"!=typeof n||a.default.compareSync(n,i.password)?i.status===m.forbidden?{error:y.accountForbidden,account:!1}:{account:{id:i.id,password:i.password,status:i.status,roles:i.roles}}:{error:y.invalidLoginOrPassword,account:!1}}))}static sendResponseError(e,n){const t=[];switch(e){case"accountForbidden":t.push({message:"Account locked",name:"Authorization error"});break;case"authentificationRequired":t.push({message:"Authentication Required",name:"Authorization error"});break;case"isNotARefreshToken":t.push({message:"Token error",name:"Is not a refresh token"});break;case"isNotAnAccessToken":t.push({message:"Token error",name:"Is not a access token"});break;case"tokenExpired":t.push({message:"Token error",name:"This token expired"});break;case"tokenWasRevoked":t.push({message:"Token error",name:"Token was revoked"});break;case"accountNotFound":case"invalidLoginOrPassword":default:t.push({message:"Invalid login or password",name:"Authorization error"})}return n.status(401).json({errors:t})}getAccounts(e){const{context:n}=this.props,{knex:t}=n,{limit:r,offset:i,orderBy:o,where:a}=e;return t.select(["j.totalCount","accounts.*"]).join(t("accounts").select(["id",t.raw('count(*) over() as "totalCount"')]).orderBy(f.convertOrderByToKnex(o)).limit(r).offset(i).where(e=>f.convertWhereToKnex(e,a)).as("j"),"j.id","accounts.id").orderBy(f.convertOrderByToKnex(o)).from("accounts").then(e=>({totalCount:(e.length?e[0]:{totalCount:0}).totalCount,limit:r,offset:i,nodes:e}))}}},function(e,n){e.exports=require("express")},function(e,n){e.exports=require("graphql")},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=i(t(34)),a=t(13),s=i(t(35)),u=t(0),d=t(1),c=t(12),l=e=>{const{context:n,authUrl:t,allowedUrl:i}=e,{endpoint:l}=e.context,{publicKey:f}=e.context.jwt,{logger:p}=n,m=new c.Authentificator({context:n}),y=a.Router();return y.post(`${t}/access-token`,s.default((n,t)=>r(void 0,void 0,void 0,(function*(){const{body:r,headers:i}=n,a=(new o.default).parse(i["user-agent"]),{login:s,password:l}=r;if("string"!=typeof s||"string"!=typeof l)throw new u.BadRequestError("login and password must be provied");p.auth.info("Access token request",{login:s});const{error:f,account:y}=yield m.getAccountByLogin(s,l);if(void 0!==f||!1===y)return p.auth.error(f,{login:s}),c.Authentificator.sendResponseError(f,t);const v=yield m.registerTokens({uuid:y.id,deviceInfo:a});t.cookie(d.TOKEN_ACCESS_TOKEN_COOKIE_KEY,v.accessToken.token,{expires:new Date((new Date).getTime()+1e3*e.context.jwt.accessTokenExpiresIn),signed:!0,httpOnly:!0,secure:!0}),t.cookie(d.TOKEN_REFRESH_TOKEN_COOKIE_KEY,v.refreshToken.token,{expires:new Date((new Date).getTime()+1e3*e.context.jwt.refreshTokenExpiresIn),signed:!0,httpOnly:!0,secure:!0});const k={accessToken:v.accessToken.token,tokenType:d.TOKEN_BEARER,expiresIn:e.context.jwt.accessTokenExpiresIn,refreshToken:v.refreshToken.token};return t.status(200).json(k)})))),y.post(`${t}/refresh-token`,s.default((t,i)=>r(void 0,void 0,void 0,(function*(){const{headers:r}=t,a=c.Authentificator.extractToken(c.TokenType.refresh,t);if(""===a)throw new u.BadRequestError("token must be provied");const s=c.Authentificator.verifyToken(a,n.jwt.publicKey);if(s.type!==c.TokenType.refresh)return p.auth.info("Tried to refresh token by access token. Rejected",{payload:s}),c.Authentificator.sendResponseError(c.ResponseErrorType.isNotARefreshToken,i);if(!(yield m.checkTokenExist(s.id)))return p.auth.info("Tried to refresh token by revoked refresh token. Rejected",{payload:s}),c.Authentificator.sendResponseError(c.ResponseErrorType.tokenWasRevoked,i);const l=(new o.default).parse(r["user-agent"]);yield m.revokeToken(s.associated),yield m.revokeToken(s.id);const f=yield m.registerTokens({uuid:s.uuid,deviceInfo:l});i.cookie(d.TOKEN_ACCESS_TOKEN_COOKIE_KEY,f.accessToken.token,{expires:new Date((new Date).getTime()+1e3*e.context.jwt.accessTokenExpiresIn),signed:!0,httpOnly:!0,secure:!0}),i.cookie(d.TOKEN_REFRESH_TOKEN_COOKIE_KEY,f.refreshToken.token,{expires:new Date((new Date).getTime()+1e3*e.context.jwt.refreshTokenExpiresIn),signed:!0,httpOnly:!0,secure:!0});const y={accessToken:f.accessToken.token,tokenType:d.TOKEN_BEARER,expiresIn:e.context.jwt.accessTokenExpiresIn,refreshToken:f.refreshToken.token};return i.status(200).json(y)})))),y.post(`${t}/validate-token`,s.default((e,n)=>r(void 0,void 0,void 0,(function*(){const{body:t}=e,{token:r}=t;if("string"!=typeof r)throw new u.BadRequestError("token must be provied");const i=c.Authentificator.verifyToken(String(r),f);n.json(i)})))),y.use(l,s.default((e,n,t)=>r(void 0,void 0,void 0,(function*(){if(i.includes(e.originalUrl))return t();const r=c.Authentificator.extractToken(c.TokenType.access,e);return c.Authentificator.verifyToken(String(r),f).type!==c.TokenType.access?c.Authentificator.sendResponseError(c.ResponseErrorType.isNotAnAccessToken,n):t()})))),y};n.authentificatorMiddleware=l,n.default=l},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(41),i=t(0),o={pool:new Map,logger:void 0};class a{static addJob(e,n){if(o.pool.get(e))throw new i.ServerError(`Cron job with name «${e}» already exists`,{jobName:e});const t=r.job(n);return o.logger&&(o.logger.server.debug(`New Cron job was added with name «${e}» at time ${n.cronTime}`,{jobConfig:n}),t.addCallback(()=>{o.logger.server.debug(`Called Cron job with name «${e}» at time ${n.cronTime}`,{jobConfig:n})})),o.pool.set(e,t),t}static getJob(e){return o.pool.get(e)}static getPool(){return o.pool}}n.CronJobManager=a,a.configure=e=>{const{logger:n}=e;o.logger=n},n.default=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TOKEN_BEARER_KEY="Authorization",n.TOKEN_ACCESS_TOKEN_COOKIE_KEY="AccessToken",n.TOKEN_REFRESH_TOKEN_COOKIE_KEY="RefreshToken",n.TOKEN_BEARER="Bearer",n.DATABASE_CHARSET="UTF8",n.DATABASE_CLIENT="pg",n.DEFAULT_SERVER_PORT=4e3,n.DEFAULT_GRAPHQL_ENDPOINT="/graphql",n.DEFAULT_GRAPHQL_SUBSCRIPTIONS_ENDPOINT="/subscriptions",n.DEFAULT_SERVER_TIMEZONE="UTC",n.DEFAULT_ROUTE_AUTH="/auth",n.DEFAULT_ROUTE_PLAYGROUND="/playground",n.DEFAULT_ROUTE_VOYAGER="/voyager",n.MAXIMUM_REQUEST_BODY_SIZE="50mb",n.DEV_INFO_DEVELOPER_NAME="Via Profit",n.DEV_INFO_DEVELOPER_URL="https://via-profit.ru"},function(e,n){e.exports=require("moment-timezone")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}(t(47))},function(e,n,t){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(t(51)),r(t(6)),r(t(5)),r(t(57))},function(e,n,t){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(t(12)),r(t(15))},function(e,n,t){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(t(23)),r(t(1)),r(t(20)),r(t(19)),r(t(0)),r(t(21))},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=t(24),a=t(25),s=i(t(7)),u=i(t(26)),d=i(t(27)),c=i(t(13)),l=i(t(28)),f=t(14),p=i(t(29)),m=t(30),y=t(31),v=t(32),k=t(33),g=t(15),h=t(19),N=t(20),T=t(61),_=t(1),E=t(76),O=t(16),b=t(78);class D{constructor(e){this.props=Object.assign({port:_.DEFAULT_SERVER_PORT,endpoint:_.DEFAULT_GRAPHQL_ENDPOINT,timezone:_.DEFAULT_SERVER_TIMEZONE,subscriptionsEndpoint:_.DEFAULT_GRAPHQL_SUBSCRIPTIONS_ENDPOINT,usePlayground:!1,useVoyager:!1},e),this.props.routes=Object.assign({auth:_.DEFAULT_ROUTE_AUTH,playground:_.DEFAULT_ROUTE_PLAYGROUND,voyager:_.DEFAULT_ROUTE_VOYAGER},this.props.routes)}bootstrap(e){const{port:n,usePlayground:t,useVoyager:r,endpoint:i,routes:o,serverOptions:s}=this.props,{app:u,schema:d,context:c}=this.createApp(),{logger:l}=c,f=a.createServer(s,u);f.listen(n,()=>{const a={graphql:`https://localhost:${n}${i}`,auth:`https://localhost:${n}${o.auth}`};t&&(a.playground=`https://localhost:${n}${o.playground}`),r&&(a.voyager=`https://localhost:${n}${o.voyager}`),l.server.debug(`App server started at «${a.graphql}»`),this.createSubscriptionServer({schema:d,server:f}),void 0!==e&&e({port:n,context:c,resolveUrl:a})})}createSubscriptionServer(e){const{subscriptionsEndpoint:n}=this.props,{server:t,schema:r}=e;return new k.SubscriptionServer({execute:f.execute,schema:r,subscribe:f.subscribe},{server:t,path:n})}createApp(){const{typeDefs:e,resolvers:n,endpoint:t,timezone:i,port:a,jwt:f,database:k,logger:D,routes:A,subscriptionsEndpoint:w,usePlayground:S,useVoyager:x,serverOptions:M}=this.props,{cookieSign:I}=M;D.server.debug("Create application proc was started");const j=c.default(),P=y.makeExecutableSchema({typeDefs:[...m.typeDefs,T.scalar.typeDefs,T.common.typeDefs,...e,T.info.typeDefs,T.accounts.typeDefs],resolvers:[m.resolvers,T.scalar.resolvers,...n,T.info.resolvers,T.accounts.resolvers],resolverValidationOptions:{requireResolversForResolveType:!1}}),R=h.knexProvider(Object.assign({localTimezone:i,logger:D},k)),F=new o.EventEmitter;O.CronJobManager.configure({logger:D});const C={endpoint:t,timezone:i,jwt:f,logger:D,knex:R,emitter:F};if(j.use(d.default({credentials:!0,origin:(e,n)=>n(null,!0)})),j.use(c.default.json({limit:_.MAXIMUM_REQUEST_BODY_SIZE})),j.use(c.default.urlencoded({extended:!0,limit:_.MAXIMUM_REQUEST_BODY_SIZE})),j.use(u.default(I)),j.use(b.headersMiddleware()),j.use(N.requestHandlerMiddleware({context:C})),j.use(g.authentificatorMiddleware({context:C,authUrl:A.auth,allowedUrl:[A.playground]})),S&&j.get(A.playground,p.default({endpoint:t})),x){const{accessToken:e}=E.configureTokens([""],C);D.server.debug("New AccessToken was created special for GraphQL voyager",{accessToken:e}),console.log(""),console.log(`${s.default.yellow.bold("Note: ")}${s.default.yellow("An access token was created specifically for GraphQL voyager")}`),console.log(`${s.default.yellow("This token was expire at")} ${s.default.yellowBright.bold(new Date(Date.now()+18e5))}`),console.log(s.default.yellow("After the token expires, you must restart the application")),j.use(A.voyager,v.express({endpointUrl:t,headersJS:JSON.stringify({Authorization:`Bearer ${e.token}`})}))}return j.use(t,l.default(()=>r(this,void 0,void 0,(function*(){return{context:C,graphiql:!1,schema:P,subscriptionsEndpoint:`ws://localhost:${a}${w}`}})))),j.use(N.errorHandlerMiddleware({context:C})),D.server.debug("Application was created"),{app:j,context:C,schema:P,routes:A}}}n.App=D,n.default=D},function(e,n){e.exports=require("events")},function(e,n){e.exports=require("https")},function(e,n){e.exports=require("cookie-parser")},function(e,n){e.exports=require("cors")},function(e,n){e.exports=require("express-graphql")},function(e,n){e.exports=require("graphql-playground-middleware-express")},function(e,n){e.exports=require("graphql-scalars")},function(e,n){e.exports=require("graphql-tools")},function(e,n){e.exports=require("graphql-voyager/middleware")},function(e,n){e.exports=require("subscriptions-transport-ws")},function(e,n){e.exports=require("device-detector-js")},function(e,n){e.exports=require("express-async-handler")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,n){super(e),this.name="BadRequestError",this.message=e,this.metaData=n,this.status=400,Object.setPrototypeOf(this,r.prototype)}}n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,n){super(e),this.name="ForbiddenError",this.message=e,this.metaData=n,this.status=403,Object.setPrototypeOf(this,r.prototype)}}n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,n){super(e),this.name="NotFoundError",this.message=e,this.metaData=n,this.status=404,Object.setPrototypeOf(this,r.prototype)}}n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,n){super(e),this.name="ServerError",this.message=e,this.metaData=n,this.status=500,Object.setPrototypeOf(this,r.prototype)}}n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,n){super(e),this.name="UnauthorizedError",this.message=e,this.metaData=n,this.status=401,Object.setPrototypeOf(this,r.prototype)}}n.default=r},function(e,n){e.exports=require("cron")},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=i(t(43));n.DataLoader=o.default;const a=new Map;n.dataloaderManager={set:(e,t,r=!1)=>{r||n.dataloaderManager.has(e)||a.set(e,t)},get:e=>a.get(e),has:e=>a.has(e),resolveByDataLoader:(e,n,t)=>r(void 0,void 0,void 0,(function*(){const r=yield t.load(e);if(!r)throw new Error(`Element not found in dataloader with key «${String(n)}»`);return void 0!==r[n]?r[n]:null})),createOrGetDataloader:(e,t,r)=>(n.dataloaderManager.get(t)||n.dataloaderManager.set(t,r(e)),n.dataloaderManager.get(t)),resolveObject:(e,t)=>{const i={};return e.forEach(e=>{i[e]=({id:i},o,a)=>r(void 0,void 0,void 0,(function*(){const r=n.dataloaderManager.createOrGetDataloader(a,"drivers",t);return yield n.dataloaderManager.resolveByDataLoader(i,e,r)}))}),i}}},function(e,n){e.exports=require("dataloader")},function(e,n){e.exports=require("bcryptjs")},function(e,n){e.exports=require("jsonwebtoken")},function(e,n){e.exports=require("uuid")},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=t(48),o=r(t(49)),a=r(t(18)),s=t(50),u=t(0),d=t(1);n.knexProvider=e=>{const{connection:n,logger:t,timezone:r,localTimezone:c}=e,l={};s.types.setTypeParser(s.types.builtins.TIMESTAMP,"text",e=>a.default.tz(e,c).toDate()),s.types.setTypeParser(s.types.builtins.TIMESTAMPTZ,"text",e=>a.default.tz(e,c).toDate()),s.types.setTypeParser(s.types.builtins.NUMERIC,parseFloat),t.server.debug("pg-types configured");let f=0;const p=o.default({client:d.DATABASE_CLIENT,connection:n,pool:{min:5,max:100,afterCreate:(e,n)=>{e.query(`\n            SET TIMEZONE = '${r}';\n            SET CLIENT_ENCODING = ${d.DATABASE_CHARSET};\n          `,i=>{i?t.sql.debug("Connection error",{err:i}):(t.sql.debug(`The TIMEZONE was set to "${r}"`),t.sql.debug(`The charset was set to "${d.DATABASE_CHARSET}"`)),n(i,e)})}}});return p.on("query",e=>{const n=e.__knexQueryUid;l[n]={position:f,startTime:i.performance.now(),finished:!1},f+=1}).on("query-response",(e,n)=>{const r=n.__knexQueryUid;l[r].endTime=i.performance.now(),l[r].finished=!0,t.sql.debug(n.sql,Object.assign({bindings:n.bindings},l[r]))}).on("query-error",(e,n)=>{console.log(n),t.sql.error(n.sql,{bindings:n.bindings,err:e})}),t.server.debug("Knex provider configured"),p.raw("SELECT 1+1 AS result").then(()=>(t.server.debug("Test the connection by trying to authenticate is OK"),!0)).catch(e=>{throw t.server.error(e.name,e),new u.ServerError(e)}),p},n.default=n.knexProvider},function(e,n){e.exports=require("perf_hooks")},function(e,n){e.exports=require("knex")},function(e,n){e.exports=require("pg")},function(e,n,t){"use strict";var r=this&&this.__rest||function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]])}return t};Object.defineProperty(n,"__esModule",{value:!0}),t(3);const i=t(52);let o;n.logger=o;const a=e=>{const{loggers:t}=e,a=r(e,["loggers"]);return n.logger=o=Object.assign({auth:i.authLogger(a),http:i.httpLogger(a),server:i.serverLogger(a),sql:i.sqlLogger(a)},t),o};n.configureLogger=a,n.default=a},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(53));n.authLogger=i.default;const o=r(t(54));n.httpLogger=o.default;const a=r(t(55));n.serverLogger=a.default;const s=r(t(56));n.sqlLogger=s.default},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=t(4);t(3);const o=r(t(5)),a=t(6);n.default=e=>{const{logDir:n}=e;return i.createLogger({level:"info",format:o.default,transports:[new i.transports.DailyRotateFile({filename:`${n}/${a.AUTH_LOG_FILENAME}`,level:"info",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"}),new i.transports.DailyRotateFile({filename:`${n}/${a.DEBUG_LOG_FILENAME}`,level:"debug",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"})]})}},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=t(4);t(3);const o=r(t(5)),a=t(6);n.default=e=>{const{logDir:n}=e;return i.createLogger({level:"info",format:o.default,transports:[new i.transports.DailyRotateFile({filename:`${n}/${a.HTTP_LOG_FILENAME}`,level:"info",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"})]})}},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=t(4);t(3);const o=r(t(5)),a=t(6);n.default=e=>{const{logDir:n}=e;return i.createLogger({level:"debug",format:o.default,transports:[new i.transports.DailyRotateFile({filename:`${n}/${a.ERRORS_LOG_FILENAME}`,level:"error",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"}),new i.transports.DailyRotateFile({filename:`${n}/${a.DEBUG_LOG_FILENAME}`,level:"debug",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"})]})}},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=t(4);t(3);const o=r(t(5)),a=t(6);n.default=e=>{const{logDir:n}=e;return i.createLogger({level:"debug",format:o.default,transports:[new i.transports.DailyRotateFile({filename:`${n}/${a.SQL_LOG_FILENAME}`,level:"debug",datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"20m",maxFiles:"14d"}),new i.transports.Console({level:"error"})]})}},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(58));n.errorHandlerMiddleware=i.default;const o=r(t(60));n.requestHandlerMiddleware=o.default},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});r(t(7));const i=r(t(59));n.default=e=>{const{context:n}=e,{logger:t}=n;return[(e,n,r,o)=>{const{status:a,stack:s,name:u,message:d,metaData:c}=e,{originalUrl:l}=n,f=d?`${a||""} ${d}`:"Unknown error";switch(a){case 401:t.auth.error(f,{originalUrl:l,stack:s,metaData:c});break;case 500:default:t.server.error(f,{originalUrl:l,stack:s,metaData:c})}r.status(a||500).json(i.default({message:d||"Please contact system administrator",name:u||"Internal server error"}))},(e,n)=>{n.status(404).end()},(e,n)=>{n.status(503).end()},(e,n)=>{n.status(400).end()}]}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=e=>{const{name:n,message:t}=e;return{errors:[{name:n||"Unknown Error",message:t||n||"Unknown Error"}]}}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=e=>{const{context:n}=e,{logger:t}=n;return(e,n,r)=>{const{method:i,originalUrl:o,headers:a}=e,s=String(e.headers["x-forwarded-for"]||"").replace(/:\d+$/,"")||e.connection.remoteAddress,u="127.0.0.1"===s||"::1"===s?"localhost":s;return t.http.info(`${u} ${i} "${o}"`,{headers:a}),r()}}},function(e,n,t){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=r(t(62));n.accounts=o;const a=i(t(66)),s=r(t(67));n.info=s;const u=r(t(72));n.scalar=u;const d={typeDefs:a.default};n.common=d},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n};Object.defineProperty(n,"__esModule",{value:!0});const o=r(t(63));n.resolvers=o.default;const a=i(t(65));n.typeDefs=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r={Query:{accounts:()=>({})},AccountsQuery:t(64).AccountsQuery};n.default=r},function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}u((r=r.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const i=t(21),o=t(11);n.AccountsQuery={list:(e,n,t)=>r(void 0,void 0,void 0,(function*(){const e=new i.Authentificator({context:t}),r=o.buildQueryFilter(n),a=yield e.getAccounts(r);return o.buildCursorConnection(a)}))},n.default=n.AccountsQuery},function(e,n){var t={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"accounts"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AccountsQuery"}}},directives:[]}]},{kind:"EnumTypeDefinition",description:{kind:"StringValue",value:"Account status",block:!0},name:{kind:"Name",value:"AccountStatus"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"allowed"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"forbidden"},directives:[]}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AccountOrderField"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"name"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"login"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"createdAt"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"updatedAt"},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Account adge bundle",block:!0},name:{kind:"Name",value:"AccountsEdge"},interfaces:[{kind:"NamedType",name:{kind:"Name",value:"Edge"}}],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"node"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Account"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"cursor"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Accounts module queries",block:!0},name:{kind:"Name",value:"AccountsQuery"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",description:{kind:"StringValue",value:"Returns Accounts list bundle",block:!0},name:{kind:"Name",value:"list"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"first"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"last"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"after"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"before"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"status"},type:{kind:"NamedType",name:{kind:"Name",value:"AccountStatus"}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"orderBy"},type:{kind:"NamedType",name:{kind:"Name",value:"AccountOrderBy"}},directives:[]}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AccountListConnection"}}},directives:[]}]},{kind:"InputObjectTypeDefinition",description:{kind:"StringValue",value:"Ordering options for accounts returned from the connection",block:!0},name:{kind:"Name",value:"AccountOrderBy"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"field"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AccountOrderField"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"direction"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OrderDirection"}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Account object",block:!0},name:{kind:"Name",value:"Account"},interfaces:[{kind:"NamedType",name:{kind:"Name",value:"Node"}}],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"name"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"login"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"password"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"status"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AccountStatus"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"createdAt"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"updatedAt"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"roles"},arguments:[],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Accounts list bundle",block:!0},name:{kind:"Name",value:"AccountListConnection"},interfaces:[{kind:"NamedType",name:{kind:"Name",value:"Connection"}}],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"totalCount"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"pageInfo"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PageInfo"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"edges"},arguments:[],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"AccountsEdge"}}}},directives:[]}]}],loc:{start:0,end:1055}};t.loc.source={body:'extend type Query {\n  accounts: AccountsQuery!\n}\n\n\n"""\nAccount status\n"""\nenum AccountStatus {\n  allowed\n  forbidden\n}\n\nenum AccountOrderField {\n  name\n  login\n  createdAt\n  updatedAt\n}\n\n\n"""\nAccount adge bundle\n"""\ntype AccountsEdge implements Edge {\n  node: Account!\n  cursor: String!\n}\n\n"""\nAccounts module queries\n"""\ntype AccountsQuery {\n\n  """\n  Returns Accounts list bundle\n  """\n  list(\n    first: Int\n    last: Int\n    after: String\n    before: String\n    status: AccountStatus\n    orderBy: AccountOrderBy\n  ): AccountListConnection!\n}\n\n"""\nOrdering options for accounts returned from the connection\n"""\ninput AccountOrderBy {\n  field: AccountOrderField!\n  direction: OrderDirection!\n}\n\n\n"""\nAccount object\n"""\ntype Account implements Node {\n  id: ID!\n  name: String!\n  login: String!\n  password: String!\n  status: AccountStatus!\n  createdAt: DateTime!\n  updatedAt: DateTime!\n  roles: [String]!\n}\n\n"""\nAccounts list bundle\n"""\ntype AccountListConnection implements Connection {\n  totalCount: Int!\n  pageInfo: PageInfo!\n  edges: [AccountsEdge]!\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},function(e,n){var t={kind:"Document",definitions:[{kind:"EnumTypeDefinition",description:{kind:"StringValue",value:"Standart ordering options",block:!0},name:{kind:"Name",value:"OrderDirection"},directives:[],values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"ASC"},directives:[]},{kind:"EnumValueDefinition",name:{kind:"Name",value:"DESC"},directives:[]}]},{kind:"InterfaceTypeDefinition",description:{kind:"StringValue",value:"Error handle interface",block:!0},name:{kind:"Name",value:"Error"},directives:[],fields:[{kind:"FieldDefinition",description:{kind:"StringValue",value:"Error name. Can be short error message",block:!0},name:{kind:"Name",value:"name"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",description:{kind:"StringValue",value:"Error detail message string",block:!0},name:{kind:"Name",value:"msg"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"InputObjectTypeDefinition",description:{kind:"StringValue",value:"Ordering options for accounts returned from the connection",block:!0},name:{kind:"Name",value:"OrderBy"},directives:[],fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"field"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DriversOrderField"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"direction"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OrderDirection"}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Information about pagination in a connection.",block:!0},name:{kind:"Name",value:"PageInfo"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"hasPreviousPage"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"hasNextPage"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"startCursor"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"endCursor"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"InterfaceTypeDefinition",description:{kind:"StringValue",value:"GraphQL Node spec. interface",block:!0},name:{kind:"Name",value:"Node"},directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"createdAt"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"updatedAt"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},directives:[]}]},{kind:"InterfaceTypeDefinition",description:{kind:"StringValue",value:"GraphQL Edge spec. interface",block:!0},name:{kind:"Name",value:"Edge"},directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"node"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Node"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"cursor"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]},{kind:"InterfaceTypeDefinition",description:{kind:"StringValue",value:"GraphQL Connection spec. interface",block:!0},name:{kind:"Name",value:"Connection"},directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"totalCount"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"pageInfo"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PageInfo"}}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"edges"},arguments:[],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Edge"}}}},directives:[]}]}],loc:{start:0,end:888}};t.loc.source={body:'"""\nStandart ordering options\n"""\nenum OrderDirection {\n  ASC\n  DESC\n}\n\n"""\nError handle interface\n"""\ninterface Error {\n  """\n  Error name. Can be short error message\n  """\n  name: String!\n\n  """\n  Error detail message string\n  """\n  msg: String\n}\n\n"""\nOrdering options for accounts returned from the connection\n"""\ninput OrderBy {\n  field: DriversOrderField!\n  direction: OrderDirection!\n}\n\n"""\nInformation about pagination in a connection.\n"""\ntype PageInfo {\n  hasPreviousPage: Boolean!\n  hasNextPage: Boolean!\n  startCursor: String\n  endCursor: String\n}\n\n"""\nGraphQL Node spec. interface\n"""\ninterface Node {\n  id: ID!\n  createdAt: DateTime!\n  updatedAt: DateTime!\n}\n\n"""\nGraphQL Edge spec. interface\n"""\ninterface Edge {\n  node: Node!\n  cursor: String!\n}\n\n"""\nGraphQL Connection spec. interface\n"""\ninterface Connection {\n  totalCount: Int!\n  pageInfo: PageInfo!\n  edges: [Edge]!\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n};Object.defineProperty(n,"__esModule",{value:!0});const o=r(t(68));n.resolvers=o.default;const a=i(t(71));n.typeDefs=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(69),i={Query:{info:()=>({})},Mutation:{info:()=>({})},InfoQuery:t(70).InfoQuery,InfoMutation:r.InfoMutation};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.InfoMutation={info:()=>!0},n.default=n.InfoMutation},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(17);n.InfoQuery={developer:()=>({name:r.DEV_INFO_DEVELOPER_NAME,url:r.DEV_INFO_DEVELOPER_URL})},n.default=n.InfoQuery},function(e,n){var t={kind:"Document",definitions:[{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"Query"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"info"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InfoQuery"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"Mutation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"info"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InfoMutation"}}},directives:[]}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"InfoMutation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"info"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Info module queries",block:!0},name:{kind:"Name",value:"InfoQuery"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",description:{kind:"StringValue",value:"Returns developer info",block:!0},name:{kind:"Name",value:"developer"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeveloperInfo"}}},directives:[]}]},{kind:"ObjectTypeDefinition",description:{kind:"StringValue",value:"Developer info",block:!0},name:{kind:"Name",value:"DeveloperInfo"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",description:{kind:"StringValue",value:"Returns developer company name",block:!0},name:{kind:"Name",value:"name"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"FieldDefinition",description:{kind:"StringValue",value:"Returns developer url",block:!0},name:{kind:"Name",value:"url"},arguments:[],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}]}],loc:{start:0,end:393}};t.loc.source={body:'type Query {\n  info: InfoQuery!\n}\n\ntype Mutation {\n  info: InfoMutation!\n}\n\n\ntype InfoMutation {\n  info: Boolean!\n}\n\n\n\n"""\nInfo module queries\n"""\ntype InfoQuery {\n\n  """\n  Returns developer info\n  """\n  developer: DeveloperInfo!\n}\n\n"""\nDeveloper info\n"""\ntype DeveloperInfo {\n\n  """\n  Returns developer company name\n  """\n  name: String!\n\n  """\n  Returns developer url\n  """\n  url: String!\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},function(e,n,t){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(73));n.resolvers=i;const o=r(t(75));n.typeDefs=o},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(74));n.Money=i.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(14);n.default=new r.GraphQLScalarType({name:"Money",description:"The value is stored in the smallest monetary unit.",serialize(e){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError(`Value is not an instance of string or number: ${JSON.stringify(e)}`);return Number(e)},parseValue(e){if("string"==typeof e)throw new TypeError(`Value is not a valid Integer: ${e}`);return BigInt(e)},parseLiteral(e){if(e.kind!==r.Kind.STRING&&e.kind!==r.Kind.INT)throw new r.GraphQLError(`Can only parse strings & integers to money but got a: ${e.kind}`);try{return BigInt(e.value)}catch(n){throw new r.GraphQLError(`Value is not a valid Date: ${e.value}`)}}})},function(e,n){var t={kind:"Document",definitions:[{kind:"ScalarTypeDefinition",description:{kind:"StringValue",value:"Money type.\nThe value is stored in the smallest monetary unit (kopecks, cents, etc.)\nReal type - Int\ne.g. For 250 USD this record returns value as 250000 (250$ * 100¢) ",block:!0},name:{kind:"Name",value:"Money"},directives:[]}],loc:{start:0,end:189}};t.loc.source={body:'"""\nMoney type.\nThe value is stored in the smallest monetary unit (kopecks, cents, etc.)\nReal type - Int\ne.g. For 250 USD this record returns value as 250000 (250$ * 100¢) \n"""\nscalar Money',name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(77)),o=t(12),a=(e,n)=>new o.Authentificator({context:n}).generateTokens({uuid:i.default(),roles:e},{access:86400,refresh:86400});n.configureTokens=a,n.default=a},function(e,n){e.exports=require("uuid/v4")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.headersMiddleware=()=>(e,n,t)=>{n.removeHeader("X-Powered-By"),n.setHeader("X-Developer","Via Profit"),t()},n.default=n.headersMiddleware}]);